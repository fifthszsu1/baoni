# 阿里云部署说明

## 🚀 快速部署

### 方法一：使用部署脚本（推荐）

#### Linux/Mac
```bash
chmod +x start-aliyun.sh
./start-aliyun.sh
```

#### Windows
```cmd
start-aliyun.bat
```

### 方法二：手动部署

#### 1. 停止现有容器
```bash
docker-compose down
```

#### 2. 清理旧镜像
```bash
docker system prune -f
```

#### 3. 构建并启动后端
```bash
docker-compose up -d --build backend
```

#### 4. 等待后端启动并检查
```bash
sleep 30
curl http://localhost:5001/health
```

#### 5. 构建并启动前端
```bash
docker-compose up -d --build frontend
```

#### 6. 检查前端
```bash
curl http://localhost:8081/
```

## 🔧 配置说明

### 主要修改

1. **Dockerfile.backend**
   - 使用 `python:3.9` 替代 `python:3.11-slim`
   - 简化依赖安装，直接使用阿里云镜像源
   - 移除复杂的条件判断

2. **docker-compose.yml**
   - 移除 `USE_CHINA_MIRROR` 参数
   - 简化构建配置

3. **网络优化**
   - 使用阿里云镜像源加速下载
   - 避免网络超时问题

## 📋 环境要求

- Docker 20.10+
- Docker Compose 2.0+
- 至少 2GB 可用内存
- 至少 5GB 可用磁盘空间

## 🌐 访问地址

- **前端**: http://your-server-ip:8081
- **后端**: http://your-server-ip:5001
- **API文档**: http://your-server-ip:5001/swagger/

## 🔍 故障排除

### 1. 网络超时问题
如果遇到网络超时，请检查：
- 服务器网络连接
- Docker Hub 访问是否正常
- 防火墙设置

### 2. 端口占用问题
如果端口被占用，可以修改 `docker-compose.yml` 中的端口映射：
```yaml
ports:
  - "8082:5000"  # 修改为其他端口
```

### 3. 内存不足
如果内存不足，可以：
- 增加服务器内存
- 或者只启动后端：`docker-compose up -d backend`

## 📞 技术支持

如果遇到问题，请检查：
1. Docker 日志：`docker-compose logs`
2. 容器状态：`docker-compose ps`
3. 系统资源：`docker stats` 